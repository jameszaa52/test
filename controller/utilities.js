sap.ui.define(["./utilities"],function(){"use strict";return{isNullOrBlank:function(e){return"boolean"!=typeof e&&(!e||null==e||""==e)},Converter:{adjustTimezone:function(e){for(var t in e){var a=e[t];if(a instanceof Date){var r=new Date;e[t]=new Date(a.getTime()-r.getTimezoneOffset()*1e3*60)}else if(a instanceof Object)this.adjustTimezone(a)}},adjustTimezone2Screen:function(e){for(var t in e){var a=e[t];if(a instanceof Date){var r=new Date;e[t]=new Date(a.getTime()+r.getTimezoneOffset()*1e3*60)}else if(a instanceof Object)this.adjustTimezone2Screen(a)}}},convertMessageTypeFormat:function(e){switch(e){case"info":return"Information";case"success":return"Success";case"warning":return"Warning";case"error":return"Error";default:return e}},getBapiRet2:function(e){var t=[];var a="";if(!e.response||!e.response.body)return;for(var r in e.response.headers){if(r.toUpperCase()=="content-type".toUpperCase()){a=e.response.headers[r];break}}if(a.indexOf("xml")>=0){try{var s=jQuery.parseXML(e.response.body);var n=$("errordetail",$(s));n.each(function(e,a){if($("code",$(a)).html()!="")return;var r=$("message",$(a)).html();if(!r)return;var s=JSON.parse(r);if(!s)return;t.push(s)});return t}catch(t){return e}}else{try{var i=JSON.parse(e.response.body);var l=i.error.innererror.errordetails;l.forEach(function(e){if(e.code!="")return;var a=e.message;if(!a)return;var r=JSON.parse(a);if(!r)return;t.push(r)});return t}catch(t){return e}}},convertErrorFormat:function(e){for(var t in e){e[t].MESSAGE=e[t].message}},deleteDuplicateRecords:function(e){var t=[];var a;for(var r=0;r<e.length;r++){a=false;for(var s=0;s<t.length;s++){if(e[r]["MESSAGE"]==t[s]["MESSAGE"]){a=true;break}}if(!a){t.push(e[r])}}return t},isHasData:function(e){if(this.isNullOrBlank(e)){return false}else{return true}},formatState:function(e){var t;switch(e){case"INITIAL":case"REVISED":{t="None";break}case"AWAITING":case"APPROVED":{t="Warning";break}case"COMPLETED":{t="Success";break}case"REJECTED":{t="Error";break}case"DELETED":{t="Error";break}default:t="None"}return t},ValueHelpDialog:{Show:function(e){var t=this;var a=jQuery.extend(true,{},{compactUi:true,basicSearchText:null,title:null,stretch:sap.ui.Device.system.phone,supportMultiselect:false,supportRanges:false,supportRangesOnly:false,fullOperationKey:false,filterMode:false,ok:function(t){try{e.callbackFunction.ok(t)}catch(e){}r.close()},cancel:function(t){try{e.callbackFunction.cancel(t)}catch(e){}r.close()},afterClose:function(){try{e.callbackFunction.afterClose()}catch(e){}r.destroy()}},e);var r=new sap.ui.comp.valuehelpdialog.ValueHelpDialog(a);var s=null;if(e.supportRangesOnly===false&&e.datas){s=r.getTable();if(!sap.ui.Device.system.phone&&!sap.ui.Device.system.tablet){this.vValueHelpTableTitle=s.getTitle().getText()}}if(s&&e.columns&&e.columns.length>0){var n=new sap.ui.model.json.JSONModel;n.setData({cols:e.columns});s.setModel(n,"columns")}var i=function(e,t){if(e&&t&&t.length>0){e.setTokens(t)}};if(e.datas instanceof Array){var l=new sap.ui.model.json.JSONModel;if(s){s.setModel(l);if(s.bindRows){s.bindRows("/")}}i(r,e.basicTokens)}else{if(s){if(e.datas.odataModel===undefined)return;if(e.datas.entitySet===undefined)return;var o=jQuery.extend(true,{},e.datas.odataModel);s.setModel(o);if(s.bindRows){s.bindRows(e.datas.entitySet);var u=s.getBinding("rows");if(e.datas.filters&&e.datas.filters instanceof Array){u.filter(e.datas.filters)}o.attachRequestCompleted(function(){if(arguments[0].getParameter("url").indexOf("$count")<0)i(r,e.basicTokens)})}}else{i(r,e.basicTokens)}}if(s&&s.bindItems&&e.columns&&e.columns.length>0){if(e.datas.entitySet!==undefined){s.bindAggregation("items",e.datas.entitySet,function(e,t){var a=s.getModel("columns").getData().cols;return new sap.m.ColumnListItem({cells:a.map(function(e){var t=e.template;return new sap.m.Label({text:"{"+t+"}"})})})})}else{s.bindAggregation("items","/",function(e,t){var a=s.getModel("columns").getData().cols;return new sap.m.ColumnListItem({cells:a.map(function(e){var t=e.template;return new sap.m.Label({text:"{"+t+"}"})})})})}}if(e.rangesKeyFields&&e.rangesKeyFields.length>0){r.setRangeKeyFields(e.rangesKeyFields)}var p={advancedMode:true,filterBarExpanded:true,searchEnabled:true,showGoOnFB:!sap.ui.Device.system.phone,search:function(){if(s){s.setBusy(true);var a=new sap.ui.model.json.JSONModel;a.setData(e.datas);if(s){s.setModel(a)}var r=null;if(sap.ui.Device.system.phone)r=s.getBinding("items");else r=s.getBinding("rows");var n=[];if(e.datas.filters&&e.datas.filters instanceof Array){for(var i in e.datas.filters){n.push(e.datas.filters[i])}}jQuery.each(arguments[0].mParameters.selectionSet,function(t,a){if(a.getValue()!=""){var r=e.filterGroupItems[t].name;var s=e.filterGroupItems[t].operation||sap.ui.model.FilterOperator.EQ;var i=a.getValue();if(e.filterGroupItems[t].uppercaseSearch==true){i=i.toUpperCase()}var l=new sap.ui.model.Filter(r,s,i,null);n.push(l)}});r.filter(n);if(!sap.ui.Device.system.phone&&!sap.ui.Device.system.tablet){s.setTitle(t.vValueHelpTableTitle+" ("+r.getLength()+")")}s.setBusy(false)}}};if(e.filterGroupItems){p.filterGroupItems=[];jQuery.each(e.filterGroupItems,function(e,t){t.control=new sap.m.Input;p.filterGroupItems.push(new sap.ui.comp.filterbar.FilterGroupItem(t))})}var c=new sap.ui.comp.filterbar.FilterBar(p);r.setFilterBar(c);if(e.compactUi){r.addStyleClass("sapUiSizeCompact")}else{r.addStyleClass("sapUiSizeCozy")}if(e.fullOperationKey){r.setIncludeRangeOperations([sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EQ,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.BT,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.LT,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.LE,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.GT,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.GE,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.Contains,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EndsWith,sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.StartsWith])}r.open();r.update()}},RetrieveToken:function(e,t){var a=[];for(var r in t){var s=null;if(t[r].getCustomData()&&t[r].getCustomData().length>0){s=t[r].getCustomData()[0].getKey()}else{s=t[r].getKey()}var n=null,i=null;if(s==="range"){n=t[r].getText();i=t[r].getCustomData()[0].getValue()}else{n="="+t[r].getKey();i={exclude:false,operation:sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation.EQ,keyField:e,value1:t[r].getKey(),value2:null}}var l=new sap.m.Token({key:"range_"+r,text:n}).data("range",i);a.push(l)}return a},DateFormatterGW:function(e){var t=sap.ui.core.format.DateFormat.getInstance({pattern:"yyyy-MM-dd"});if(e){return"datetime'"+t.format(e)+"T00:00:00'"}},GenerateProcessLogModel:function(e,t,a,r){if(!a){return}if(!e){return}var s="/ReservHistorySet";var n=[new sap.ui.model.Filter("Reserno","EQ",a,true),new sap.ui.model.Filter("Operno","EQ",r,true)];var i=this;return $.proxy(this.AsyncCallQueryService,this)("Send to approver",e,s,n,function e(a,r){t.setData({Nodes:[],Lanes:[]});var s=[];var n=[];var l=0;a.results.forEach(function(e){var t=[];l++;if(parseInt(e.Applevel)<a.results.length){t.push("0"+(parseInt(e.Applevel)+1))}var r="Positive";if(e.Status==="PENDING"){r="Planned"}else if(e.Status==="REJECTED"){r="Negative"}else if(e.Status.indexOf("AWAITING")>=0){r="Critical"}else if(e.Status==="REVISED"){r="Neutral"}var n={lane:e.Applevel,id:e.Applevel,title:"Approver "+parseInt(e.Applevel),titleAbbreviation:"Approver "+parseInt(e.Applevel),isTitleClickable:false,children:t,state:r,stateText:e.StatusDescp,texts:e.ActionDate===null?[]:[i.adjustDateFormatDisplay(e.ActionDate)+" ["+i.adjustTimeFormatDisplay(e.ActionTime)+"]"]};s.push(n)});a.results.forEach(function(e){var t="sap-icon://accept";if(e.Status==="PENDING"){t="sap-icon://customer-history"}else if(e.Status==="REJECTED"){t="sap-icon://decline"}else if(e.Status.indexOf("AWAITING")>=0){t="sap-icon://pending"}else if(e.Status==="REVISED"){t="sap-icon://edit-outside"}var a={id:e.Applevel,icon:t,label:e.Actor,position:parseInt(e.Applevel)-1};n.push(a)});t.setProperty("/Nodes",s);t.setProperty("/Lanes",n)},function e(){})}}});